# Story 3.4: Performance Comparison & Visualization

Status: ready-for-dev

## Story

As a developer,
I want comparative analysis charts and summary tables generated from benchmark results,
so that the performance findings are clearly communicated visually.

## Acceptance Criteria

1. **Speedup Chart:** Line plot with Speedup (y-axis) vs. Number of Workers (x-axis). Includes ideal linear speedup reference line.
2. **Epoch Time Chart:** Bar chart comparing average per-epoch wall-clock time across all configurations.
3. **Communication Overhead Chart:** Stacked bar chart showing computation time vs. communication time per configuration.
4. **Accuracy vs. Speedup Trade-off:** Scatter plot or table showing F1-score vs. speedup for each configuration.
5. **Scaling Efficiency Chart:** Plot of efficiency (Speedup / P) vs. number of workers P.
6. **Summary Table:** Consolidated table with all metrics for all configurations (printed to console and saved as CSV).
7. All charts saved as image files (PNG) in `results/`.

## Tasks / Subtasks

- [ ] Task 1: Implement speedup chart (AC: #1)
  - [ ] Load benchmark summary CSV
  - [ ] Plot actual speedup vs. workers (1, 2, 4, 8, 16)
  - [ ] Plot ideal linear speedup line (y = x) for reference
  - [ ] Save to `results/speedup_chart.png`
- [ ] Task 2: Implement epoch time chart (AC: #2)
  - [ ] Bar chart with one bar per configuration (sequential, spark-1, spark-2, ..., spark-16)
  - [ ] Y-axis: average per-epoch time (seconds), with error bars for std dev
  - [ ] Save to `results/epoch_time_chart.png`
- [ ] Task 3: Implement communication overhead chart (AC: #3)
  - [ ] Stacked bar chart per Spark configuration
  - [ ] Two segments: computation time (bottom) and communication time (top)
  - [ ] Save to `results/comm_overhead_chart.png`
- [ ] Task 4: Implement accuracy vs. speedup chart (AC: #4)
  - [ ] Scatter plot: x-axis = speedup, y-axis = test F1-score
  - [ ] Label each point with its configuration name
  - [ ] Save to `results/accuracy_vs_speedup.png`
- [ ] Task 5: Implement scaling efficiency chart (AC: #5)
  - [ ] Line plot: x-axis = P (workers), y-axis = Speedup / P (efficiency, ideal = 1.0)
  - [ ] Include horizontal reference line at y = 1.0
  - [ ] Save to `results/scaling_efficiency_chart.png`
- [ ] Task 6: Generate summary table (AC: #6)
  - [ ] Consolidated table: config, workers, avg_epoch_time, total_time, speedup, efficiency, comm_overhead_%, test_f1, peak_memory
  - [ ] Print to console in formatted table
  - [ ] Save to `results/summary_table.csv`

## Dev Notes

- **Target file:** `src/utils/visualization.py`
- **Library:** Use `matplotlib` for all charts. Use `pandas` for table formatting.
- **Chart styling:** Use clear labels, titles, legends, grid lines. Publication-quality preferred (for the report).
- **Input:** Reads from `results/benchmark_summary.csv` and individual run CSVs generated by Story 3.3.
- **Error bars:** Use std dev from repeated runs for epoch time and F1 charts.

### Project Structure Notes

- `src/utils/visualization.py` — All plotting functions
- `results/` — Output directory for PNG charts and CSV tables
- Depends on: Story 3.3 (benchmark results CSVs)

### References

- [Source: _bmad-output/planning-artifacts/requirements.md#REQ-P3-003]
